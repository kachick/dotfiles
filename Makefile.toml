[config]
skip_core_tasks = true

[tasks.default]
alias = "help"

[tasks.help]
script = [
  'makers --list-all-steps',
]

[tasks.setup]
script = [
  "git config --local core.hooksPath .githooks",
]

[tasks.update]
script = [
  "dprint config update --yes",
]

[tasks.lint]
command = 'go'
args = [
  'run',
  './cmd/lint',
]

[tasks.fmt]
command = 'go'
args = [
  'run',
  './cmd/fmt',
]

[tasks.check]
alias = "lint"

[tasks.deps]
command = 'go'
args = [
  'run',
  './cmd/print-deps',
]

[tasks.prepare-build]
command = 'mkdir'
args = ['-p', 'dist']

[tasks.build]
dependencies = ['prepare-build']
command = 'go'
args = [
  'build',
  '-v',
  '-o',
  'dist',
  './...',
]

[tasks.test-race]
dependencies = ['prepare-build']
command = 'go'
args = [
  'build',
  '-v',
  '-race',
  '-o',
  'dist',
  './...',
]

[tasks.apply]
script = [
  "home-manager switch -f ./home/.config/home-manager/home.nix",
]
